<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Custom Registration</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9fafc;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .register-box {
      background: white;
      border-radius: 12px;
      padding: 30px;
      max-width: 400px;
      width: 100%;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      text-align: center;
    }
    .register-box h2 { margin-bottom: 10px; }
    .input {
      width: 100%; margin-bottom: 15px; padding: 12px;
      border: 1px solid #ccc; border-radius: 6px; font-size: 14px;
    }
    .btn {
      width: 100%; padding: 12px;
      border: none; border-radius: 6px;
      font-size: 15px; font-weight: bold;
      cursor: pointer; margin-bottom: 10px;
      display: flex; align-items: center; justify-content: center; gap: 8px;
    }
    .btn-primary { background: #4a4aff; color: white; }
    .btn-google   { background: white; border: 1px solid #ccc; }
    .btn-facebook { background: #1877f2; color: white; }
    .btn-apple    { background: black; color: white; }
    .icon { width: 18px; height: 18px; display: inline-block; }
    small { display: block; margin-top: 15px; }
    a { color: #4a4aff; cursor: pointer; text-decoration: none; }
    .error { color: #ff4d4d; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="register-box">
    <h2>Register Account</h2>
    <p>Create your account to access the scheduler</p>

    <input type="email" id="email" class="input" placeholder="Email address" />
    <input type="password" id="password" class="input" placeholder="Password" />
    <input type="password" id="confirmPassword" class="input" placeholder="Confirm Password" />
    <button class="btn btn-primary" onclick="handleRegister()" id="registerBtn">Register</button>

    <small>
      <span>Already have an account?</span> 
      <a href="/">Login</a>
    </small>

    <hr/>

    <!-- Google -->
    <button class="btn btn-google" onclick="loginGoogle()">
      <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512">
        <path fill="#EA4335"
          d="M488 261.8c0-17.4-1.5-34.1-4.4-50.4H249v95.3h134.3c-5.8 
          31.4-23.3 57.9-49.6 75.7v62h80.3c47-43.3 74-107.2 
          74-182.6z"/>
        <path fill="#34A853"
          d="M249 492c66 0 121.1-21.9 161.5-59.6l-80.3-62c-22.3 
          15-50.9 23.7-81.2 23.7-62.3 
          0-115.2-42-133.9-98.5h-82.6v61.8C74.7 
          444.1 156.1 492 249 492z"/>
        <path fill="#4A90E2"
          d="M115.1 295.6c-4.6-13.6-7.2-28.2-7.2-43.1s2.6-29.5 
          7.2-43.1v-61.8H32.5C12 
          189.9 0 217.4 0 249s12 59.1 32.5 
          81.4l82.6-61.8z"/>
        <path fill="#FBBC05"
          d="M249 100.4c36 0 68.3 12.4 
          93.8 36.8l70.2-70.2C370.2 
          25.2 315.1 0 249 0 156.1 0 74.7 
          47.9 32.5 122.6l82.6 61.8c18.7-56.5 
          71.6-98.5 133.9-98.5z"/>
      </svg>
      Continue with Google
    </button>

    <!-- Facebook -->
    <button class="btn btn-facebook" onclick="loginFacebook()">
      <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
        <path fill="white"
          d="M279.14 288l14.22-92.66h-88.91V134.87c0-25.35 
           12.42-50.06 52.24-50.06h40.42V6.26S293.3 0 268.08 
           0c-73.12 0-121.08 44.38-121.08 
           124.72v70.62H86.41V288h60.59v224h92.66V288z"/>
      </svg>
      Continue with Facebook
    </button>

    <!-- Apple -->
    <button class="btn btn-apple" onclick="loginApple()">
      <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
        <path fill="white" 
          d="M318.7 268.7c-.1-36.7 16-64.4 
          50.7-84.8-19.2-27.6-47.9-43-85.2-46.2-35.8-3.1-74.2 
          21.3-88.4 21.3-14.6 0-48.1-20.6-74.4-20.1-38 
          .6-70.9 22-89.8 55.6-38.5 66.8-9.8 
          165.7 27.6 220.1 18.3 26.5 40 56.3 
          68.8 55.2 27.5-1.1 38-17.5 
          71.2-17.5s43.1 17.5 74.4 
          17c29.7-.5 48.4-26.9 66.7-53.5 
          21-30.6 29.7-60.3 
          30.1-61.9-0.8-0.3-57.6-22.1-57.7-87.2zM255.6 
          70.2c18.7-22.6 31.4-54.1 
          27.9-85.2-27 
          1.1-59.6 18-78.9 
          40.6-17.3 
          19.8-32.6 51.6-28.5 82.4 
          30.2 2.3 
          61.1-15.3 79.5-37.8z"/>
      </svg>
      Continue with Apple
    </button>

    <small id="status"></small>
    <div id="error" class="error"></div>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js "></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth-compat.js "></script>

  <script>
    // âœ… Firebase config (fixed bucket)
    const firebaseConfig = {
      apiKey: "AIzaSyAcNhqW9wkLs3S7O5bp4GMJ0SWJ4d-7GRo",
      authDomain: "email-scheduler-80501.firebaseapp.com",
      projectId: "email-scheduler-80501",
      storageBucket: "email-scheduler-80501.appspot.com",
      messagingSenderId: "357118084169",
      appId: "1:357118084169:web:1140c0a3f67f0e9bdfeb98",
      measurementId: "G-96971SLQXH"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    async function handleRegister() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const confirmPassword = document.getElementById("confirmPassword").value;
      
      // Validation
      if (!email || !password || !confirmPassword) {
        document.getElementById("error").innerText = "All fields are required";
        return;
      }
      
      if (password !== confirmPassword) {
        document.getElementById("error").innerText = "Passwords do not match";
        return;
      }
      
      if (password.length < 6) {
        document.getElementById("error").innerText = "Password must be at least 6 characters";
        return;
      }
      
      try {
        // Create user with Firebase
        const userCred = await auth.createUserWithEmailAndPassword(email, password);
        
        // Send email verification
        await userCred.user.sendEmailVerification();
        
        // Show success message
        document.getElementById("status").innerText = "Registration successful! Verification email sent.";
        document.getElementById("error").innerText = "";
        
        // Redirect after delay
        setTimeout(() => {
          window.location.href = "/";
        }, 2000);
      } catch (err) {
        document.getElementById("error").innerText = err.message;
      }
    }

    async function loginGoogle() {
      const provider = new firebase.auth.GoogleAuthProvider();
      try {
        const result = await auth.signInWithPopup(provider);
        document.getElementById("status").innerText = "Google login: " + result.user.displayName;
        const token = await result.user.getIdToken();
        localStorage.setItem("idToken", token);
        window.location.href = "/dashboard.html";
      } catch (err) {
        document.getElementById("status").innerText = err.message;
      }
    }

    async function loginFacebook() {
      const provider = new firebase.auth.FacebookAuthProvider();
      try {
        const result = await auth.signInWithPopup(provider);
        document.getElementById("status").innerText = "Facebook login: " + result.user.displayName;
        const token = await result.user.getIdToken();
        localStorage.setItem("idToken", token);
        window.location.href = "/dashboard.html";
      } catch (err) {
        document.getElementById("status").innerText = err.message;
      }
    }

    async function loginApple() {
      const provider = new firebase.auth.OAuthProvider("apple.com");
      try {
        const result = await auth.signInWithPopup(provider);
        document.getElementById("status").innerText = "Apple login: " + result.user.displayName;
        const token = await result.user.getIdToken();
        localStorage.setItem("idToken", token);
        window.location.href = "/dashboard.html";
      } catch (err) {
        document.getElementById("status").innerText = err.message;
      }
    }
  </script>
</body>
</html>
